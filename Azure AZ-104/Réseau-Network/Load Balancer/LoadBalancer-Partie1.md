---
title: Load Balancer - P1
parent: R√©seau-Network
grand_parent: Certification AZ-104
nav_order: 15
nav_exclude: true
---

# DNS dans Azure : services et fonctionnalit√©s

Le Domain Name System (DNS) est le service essentiel qui traduit un nom de domaine (comme www.contoso.com) en adresse IP afin de permettre la communication entre les ressources r√©seau.

Dans Azure, cette fonction est assur√©e par Azure DNS, un service manag√© offrant h√©bergement, r√©solution et √©quilibrage DNS au sein de l‚Äôinfrastructure mondiale de Microsoft.
Il permet d‚Äôadministrer vos zones DNS avec la m√™me s√©curit√©, les m√™mes outils et la m√™me facturation que vos autres services Azure.


# Services DNS dans Azure

Il existe plusieurs **services et fonctionnalit√©s DNS** disponibles dans Microsoft Azure :


### ‚Ä¢ **Azure DNS**  
Azure DNS est un **service manag√©** qui permet d‚Äôh√©berger vos domaines directement dans Azure. Il fournit des **serveurs de noms hautement disponibles** et offre la possibilit√© de **cr√©er, g√©rer et r√©soudre** des enregistrements DNS (A, CNAME, MX, TXT, etc.) pour vos domaines.  

Vous pouvez y g√©rer vos enregistrements DNS (A, CNAME, MX, TXT, etc.) via le portail Azure, Azure CLI ou des API, avec la m√™me gestion d‚Äôidentit√© et de facturation que vos autres ressources Azure.
Les serveurs de noms d‚ÄôAzure DNS sont distribu√©s mondialement pour assurer rapidit√©, fiabilit√© et haute disponibilit√©.

Azure DNS prend en charge deux types de zones :  
- **Zones publiques** : permettent d‚Äôh√©berger vos domaines accessibles depuis Internet sans avoir √† g√©rer de serveurs DNS externes.
Vous pouvez soit acheter un nom de domaine directement via App Service Domains (√† ne pas confondre avec Active Directory Domain Services ‚Äì ce sont deux services distincts),
soit transf√©rer la gestion DNS d‚Äôun domaine d√©j√† existant depuis votre registrar vers Azure DNS.
Ce service offre une gestion centralis√©e et s√©curis√©e de vos enregistrements DNS publics tout en b√©n√©ficiant de la haute disponibilit√© et de la r√©silience de l‚Äôinfrastructure Azure.
- **Zones priv√©es** : assurent la r√©solution interne des noms dans vos r√©seaux virtuels (VNets) sans n√©cessiter de serveurs DNS personnalis√©s.
Les ressources Azure connect√©es au m√™me r√©seau peuvent ainsi se d√©couvrir automatiquement via des noms conviviaux plut√¥t que des adresses IP.
Ce service simplifie la gestion DNS interne tout en garantissant la s√©curit√© et l‚Äôisolation du r√©seau. 

L‚Äôutilisation des zones priv√©es DNS permet de g√©rer la r√©solution interne au sein de r√©seaux complexes sans d√©ployer de serveur DNS.  
Ce service est **facturable** selon le nombre de zones et de requ√™tes DNS trait√©es.  
> Azure DNS est **couvert par la certification AZ-104**, qui inclut la cr√©ation, la gestion et la liaison de zones publiques et priv√©es.

---

### ‚Ä¢ **Azure Traffic Manager**  
Azure Traffic Manager est un **service DNS intelligent** utilis√© pour la **gestion du trafic global**. Contrairement √† Azure DNS, qui renvoie toujours la m√™me r√©ponse √† une requ√™te donn√©e, Traffic Manager peut fournir **des r√©ponses dynamiques** selon plusieurs crit√®res :  
- la **localisation g√©ographique** de l‚Äôutilisateur,  
- la **latence r√©seau**,  
- la **disponibilit√©** des points de terminaison (endpoints).  

Il utilise DNS pour diriger les utilisateurs vers l‚Äôinstance de service la plus performante ou la plus proche, que ce soit dans Azure, on-premises ou dans un autre cloud.  
Le service est **facturable** en fonction du nombre de requ√™tes trait√©es.  
> Bien que Traffic Manager fasse partie de l‚Äô√©cosyst√®me DNS Azure, sa mise en ≈ìuvre n‚Äôest **pas couverte par l‚Äôexamen AZ-104**.

---

### ‚Ä¢ **App Service Domains**  
Le service **App Service Domains** permet **l‚Äôachat et la gestion de noms de domaine** directement depuis le portail Azure. Ces domaines peuvent ensuite √™tre h√©berg√©s dans **Azure DNS** pour la gestion des enregistrements.  

Ce service est **int√©gr√© √† Azure App Service**, mais peut √™tre utilis√© pour tout type d‚Äôapplication, m√™me en dehors de ce contexte.  
Il est **facturable** comme tout service d‚Äôenregistrement de domaine.  
> Ce service n‚Äôest **pas inclus dans le p√©rim√®tre de l‚Äôexamen AZ-104**, mais il est utile pour la mise en place rapide d‚Äôenvironnements web.

---

## üîπ Fonctionnalit√©s DNS int√©gr√©es √† Azure

### ‚Ä¢ **Azure-provided DNS (DNS interne Azure)**  
Aussi appel√© **DNS interne**, il est **fourni automatiquement** pour chaque r√©seau virtuel (VNet). Il permet aux **machines virtuelles** d‚Äôun m√™me r√©seau de se d√©couvrir et de communiquer entre elles √† l‚Äôaide de leurs **noms d‚Äôh√¥te**.  

Les requ√™tes sont internes au VNet et ne sortent jamais de l‚Äôenvironnement Azure.  
Cette fonctionnalit√© n‚Äôest **pas facturable**, car elle fait partie du service de base du r√©seau virtuel.  

---

### ‚Ä¢ **DNS r√©cursif (ou ‚ÄúBring Your Own DNS‚Äù)**  
Azure offre par d√©faut un service de **r√©solution r√©cursive** permettant √† vos machines virtuelles de r√©soudre les noms publics sur Internet. Toutefois, vous pouvez choisir d‚Äôutiliser **votre propre serveur DNS** :  
- un **DNS on-premises** connect√© via VPN,  
- un **contr√¥leur de domaine Active Directory**,  
- ou un **serveur DNS personnalis√©** h√©berg√© dans Azure.  

Cette approche, souvent appel√©e ‚Äú**Bring Your Own DNS**‚Äù, permet d‚Äôint√©grer Azure √† des environnements DNS d‚Äôentreprise.  
Cette fonctionnalit√© n‚Äôest **pas facturable**, mais n√©cessite de maintenir vos propres serveurs DNS.  

---

### ‚Ä¢ **Reverse DNS (DNS inverse)**  
Le **Reverse DNS** permet la **r√©solution inverse** (IP ‚Üí nom de domaine) en utilisant des enregistrements **PTR**. Cette fonctionnalit√© est disponible pour les **adresses IP publiques Azure** et peut aussi √™tre utilis√©e dans des zones DNS internes.  

Les zones inverses (`in-addr.arpa` ou `ip6.arpa`) pour des blocs IP que vous poss√©dez peuvent √©galement √™tre h√©berg√©es dans Azure DNS.  
Cette fonctionnalit√© n‚Äôest pas directement factur√©e, sauf si vous h√©bergez la zone PTR dans Azure DNS.  
> Le reverse DNS n‚Äôest **pas au programme de l‚Äôexamen AZ-104**, mais reste utile pour les sc√©narios de messagerie et de v√©rification d‚Äôidentit√© IP.

---

## üìò R√©sum√©

| √âl√©ment | Type | Facturation  | Description principale |
|:--|:--:|:--:|:--:|
| **Azure DNS** | Service | ‚úÖ Oui | H√©bergement DNS public et priv√© |
| **Azure Traffic Manager** | Service | ‚úÖ Oui |R√©partition DNS intelligente du trafic global |
| **App Service Domains** | Service | ‚úÖ Oui | Achat et gestion de domaines dans Azure |
| **Azure-provided DNS** | Fonctionnalit√© | ‚ùå Non | DNS interne pour la r√©solution VM-√†-VM |
| **DNS r√©cursif / BYO DNS** | Fonctionnalit√© | ‚úÖ Oui | Utilisation d‚Äôun DNS personnalis√© ou d‚Äôentreprise |
| **Reverse DNS** | Fonctionnalit√© | ‚ö†Ô∏è Partiel | R√©solution inverse IP ‚Üí nom |

---
---
---

# üåê Gestion compl√®te du DNS dans Azure

## 1. Cr√©ation et d√©l√©gation d‚Äôune zone DNS publique

### Comprendre le r√¥le d‚Äôune zone DNS
Une **zone DNS** dans Azure est une ressource qui h√©berge les enregistrements DNS d‚Äôun domaine. Lorsque vous cr√©ez une zone DNS dans **Azure DNS**, celle-ci se voit attribuer automatiquement **quatre serveurs de noms autoritatifs** (name servers) h√©berg√©s par Microsoft. Ces serveurs r√©pondent aux requ√™tes DNS en fonction des enregistrements configur√©s dans la zone.

> üí° **Remarque :** Vous pouvez cr√©er une zone DNS sans poss√©der le nom de domaine correspondant. Cependant, pour la rendre accessible publiquement, une **d√©l√©gation de domaine** depuis le registrar est n√©cessaire.

Il faut savoir que la zone DNS est par d√©faut Global, elle n'a donc pas de r√©gion sp√©cifique de d√©ploiement.

### √âtapes de cr√©ation d‚Äôune zone DNS publique
1. Cr√©ez une ressource **DNS Zone** dans Azure via le portail, Azure CLI ou PowerShell. 
2. Lors de la cr√©ation de la zone, vous pouvez importer un fichier contenant les enregistrements de votre zone ou le r√©diger manuellement. 
3. Azure attribue automatiquement quatre serveurs de noms (ex. `ns1-xx.azure-dns.com`, `ns2-xx.azure-dns.net`, etc.).  
4. V√©rifiez les serveurs attribu√©s dans le **portail Azure** ou √† l‚Äôaide de la **CLI/PowerShell**. Chaque zone poss√®de un ensemble de serveurs unique. `Azure Portal > VotreZoneDNS > Settings > Properties`
5. Configurez la d√©l√©gation du domaine aupr√®s de votre **registrar** (OVH, namecheap...):
   - Remplacez les enregistrements **NS** existants par ceux fournis par Azure DNS.  
   - N‚Äôutilisez **jamais** de glue records pointant directement vers les adresses IP des serveurs Azure DNS (ces IP peuvent changer).

> üö´ Les **vanity name servers** (serveurs dont le nom correspond √† votre domaine) ne sont pas pris en charge.

![alt text](image-1.png)

![alt text](image-7.png)

### D√©l√©gation d‚Äôune zone enfant
Azure traite les **zones enfants** comme des entit√©s ind√©pendantes. La d√©l√©gation d‚Äôune sous-zone suit les m√™mes √©tapes que pour une zone principale :
1. Cr√©ez la zone enfant dans Azure DNS.  
2. Identifiez les serveurs de noms associ√©s √† la zone enfant.  
3. Ajoutez des enregistrements **NS** dans la zone parente, pointant vers les serveurs de la zone enfant.  

> ‚ö†Ô∏è Si des enregistrements portant le m√™me nom existent d√©j√† dans la zone parente, ils deviendront inaccessibles une fois la d√©l√©gation effectu√©e. Pensez √† les **r√©pliquer dans la zone enfant** avant la d√©l√©gation.

---

## 2. Gestion des enregistrements DNS

Chaque enregistrement DNS dans Azure comprend :
- **Nom** : combin√© avec le nom de la zone pour former le **FQDN** (ex. `www` dans `contoso.com` ‚Üí `www.contoso.com`).  
- **Type** : d√©termine la nature des donn√©es (A, CNAME, MX, etc.).  
- **TTL (Time-To-Live)** : dur√©e de mise en cache de l‚Äôenregistrement.  
- **RDATA** : contenu associ√© √† l‚Äôenregistrement (adresse IP, nom de domaine, etc.).

Les enregistrements de m√™me nom et type forment un **record set (RRSet)**. Chaque record set peut contenir jusqu‚Äô√† **20 enregistrements individuels**. Pour le **root domain**, utilisez le symbole `@`.


### Cr√©ation d‚Äôun enregistrement DNS
- Acc√©dez √† la zone DNS ‚Üí DNS Management ‚Üí **+ Record Set** ‚Üí Add
- Renseignez les champs :
  - **Name** : `www`  
  - **Type** : A  
  - **Alias record set** : No  
  - **TTL** : 1 heure (modifiable)  
  - **IP Address** : ajoutez une ou plusieurs adresses IPv4  

### Exemple d‚ÄôAlias Record au niveau du domaine racine
Pour un enregistrement au niveau du domaine (apex), utilisez :
- **Name** : `aliasdewww`  
- **Type** : A  
- **Alias Record Set** : Oui  
- **Azure resource** : vous avez le choix entre plusieurs options (Figure 1.2) ou  **Zone record set** : vous pouvez choisir un enregistrement dans la zone actuelle.
- **TTL** : 1 heure  

![alt text](image-3.png)
Figure 1.2

### Principaux types d‚Äôenregistrements pris en charge

| Type | Description | Remarques |
|------|--------------|------------|
| **A / AAAA** | Mappe un nom vers une adresse IPv4 / IPv6. | Standard. |
| **CAA** | Indique les autorit√©s de certification autoris√©es. | Configurable via CLI/PowerShell uniquement. |
| **CNAME** | Alias d‚Äôun nom vers un autre nom DNS. | Non autoris√© au niveau du zone apex. |
| **MX** | Configure le routage des emails. | ‚Äî |
| **NS** | Indique les serveurs de noms d‚Äôune zone. | Cr√©√© automatiquement √† la cr√©ation de la zone. |
| **PTR** | Effectue une recherche DNS invers√©e. | Utilis√© pour le reverse DNS. |
| **SOA** | Sp√©cifie les informations d‚Äôautorit√© de la zone. | Cr√©√© et supprim√© automatiquement. |
| **SRV** | Permet la d√©couverte de services. | Format : `_service._protocol.domain.com`. |
| **TXT** | Utilis√© pour du SPF, la validation de domaine, etc. | Le type SPF est obsol√®te (RFC7208). |

### üîó Alias Records (Int√©gration Azure)
Les **alias records** permettent de r√©f√©rencer directement des ressources Azure (Public IP, Traffic Manager, ou autre enregistrement de la m√™me zone). Ces enregistrements :
- S‚Äôactualisent automatiquement si la ressource change d‚Äôadresse IP.  
- √âvitent les enregistrements orphelins lorsque les ressources sont supprim√©es.  
- Permettent la r√©solution dynamique avec **Traffic Manager** sans CNAME.  

Un alias record est support√© dans Azure DNS pour les types A, AAAA et CNAME.

- Pour le type A / AAAA : pointez vers une IP publique Azure (ressource Public IP). 
- Pour le type A / AAAA / CNAME : pointez vers un profil Traffic Manager ‚Äî c‚Äôest particuli√®rement utile pour la gestion du trafic ou pour pouvoir utiliser un alias au niveau du domaine racine (zone apex), ce que les CNAME classiques ne permettent pas. 

**D‚Äôautres possibilit√©s d‚Äôalias :**

- vers un point de terminaison CDN Azure (utile pour h√©berger des sites statiques) 
- vers un autre record dans la m√™me zone (r√©f√©rence interne) 
- vers un endpoint Front Door Azure pour personnaliser un domaine sur un front global.


Dans le DNS classique, un enregistrement *peut rester actif* m√™me si la ressource qu‚Äôil cible (IP, CNAME, etc.) a √©t√© supprim√©e.

R√©sultat : le DNS pointe vers une adresse invalide ‚Äî voire r√©attribu√©e ‚Äî cr√©ant un risque d‚Äôerreur ou de d√©tournement de trafic.

Les alias records d‚ÄôAzure DNS √©vitent ce probl√®me en liant automatiquement le cycle de vie du DNS √† celui de la ressource Azure.
Si la ressource (Public IP, Traffic Manager, etc.) change ou est supprim√©e :

le DNS est mis √† jour automatiquement, ou l‚Äôenregistrement devient vide, sans intervention manuelle.

Cela garantit une r√©solution propre, sans enregistrements orphelins, ni risque de redirection accidentelle. ‚úÖ 

> Les Alias Records est une extension non d√©finie dans les RFC DNS classiques. Il se peut qu'en dehors d‚ÄôAzure (chez d'autres registars), le comportement √©quivalent doit √™tre simul√© manuellement.

---

## 3. Configuration des param√®tres DNS, Built-in et personnalisation :

### üîß Azure-provided DNS
Par d√©faut, chaque machine virtuelle dans un **Virtual Network (VNet)** re√ßoit via **DHCP** :
- Une **adresse IP priv√©e**, et  
- Des **param√®tres DNS** utilisant le service DNS interne d‚ÄôAzure (`168.63.129.16`).

Ce service offre :
- Une **r√©solution interne** VM-√†-VM dans le m√™me r√©seau virtuel.  
- Une **r√©solution Internet** pour les domaines publics.  

Les noms internes suivent le format :  
`<nom_VM>.<suffixe_al√©atoire_dns>.internal.cloudapp.net`  
Ces noms ne sont r√©solus qu‚Äô√† l‚Äôint√©rieur du r√©seau virtuel.

![alt text](image-4.png)
Figure 1.3

Ces deux vm on √©taient d√©ployer sans aucune configuration personnalis√© du DNS.

```bash
azure@vm01:~$ ping vm01
PING vm01.pncdymwalfue3izxlcvqxqceth.bx.internal.cloudapp.net (10.0.0.4) 56(84) bytes of data.
64 bytes from vm01.internal.cloudapp.net (10.0.0.4): icmp_seq=1 ttl=64 time=0.018 ms
64 bytes from vm01.internal.cloudapp.net (10.0.0.4): icmp_seq=2 ttl=64 time=0.020 ms
64 bytes from vm01.internal.cloudapp.net (10.0.0.4): icmp_seq=3 ttl=64 time=0.019 ms

azure@vm01:~$ ping vm02
PING vm02.pncdymwalfue3izxlcvqxqceth.bx.internal.cloudapp.net (10.0.0.5) 56(84) bytes of data.
64 bytes from vm02.internal.cloudapp.net (10.0.0.5): icmp_seq=1 ttl=64 time=1.34 ms
64 bytes from vm02.internal.cloudapp.net (10.0.0.5): icmp_seq=2 ttl=64 time=2.38 ms
64 bytes from vm02.internal.cloudapp.net (10.0.0.5): icmp_seq=3 ttl=64 time=0.930 ms
```

### üîß Le principe du Bring Your Own DNS (BYODNS)
Vous pouvez remplacer le DNS fourni par Azure par vos **propres serveurs DNS**, h√©berg√©s :
- dans Azure (sur une VM),  
- sur site (on-premises), ou  
- sur Internet (ex. `8.8.8.8`).

Cela permet :
- la **r√©solution inter-VNet**,  
- la **r√©solution hybride Azure/On-prem**,  
- la **r√©solution invers√©e (PTR)**,  
- la **prise en charge d‚ÄôActive Directory**.

> üîí Les serveurs DNS personnalis√©s doivent offrir un service **r√©cursif**, sinon la r√©solution Internet √©chouera.

### üîß Configuration des DNS personnalis√©s
On peut modifier l'impl√©mentation du DNS √† plusieurs niveaux, par exemple :
- **Niveau VNet** : applique les DNS √† toutes les VMs du r√©seau.  
- **Niveau interface r√©seau (NIC)** : par d√©faut, la carte r√©seau (NIC) h√©rite du DNS du VNet, quand on le passe sur le mode custom, il devient prioritaire sur le VNet.  
  > Si plusieurs VMs sont dans un *availability set*, les DNS configur√©s sur leurs interfaces sont fusionn√©s.

**Au niveau du vnet** :

![alt text](image-5.png)


**Au niveau de l'interface r√©seau (NIC)** :

![alt text](image-6.png)


> ‚ö†Ô∏è Il n‚Äôest **pas possible** de d√©finir des DNS au niveau du **sous-r√©seau (subnet)**.

Apr√®s modification :
- Les VMs doivent **red√©marrer** pour appliquer les nouveaux param√®tres DNS.  
- Azure red√©marre automatiquement les VMs concern√©es lors de la mise √† jour au niveau de la NIC.

---

## 5. Zones DNS priv√©es (Private DNS Zones)

En plus des zones DNS publics, Azure prend en charge les **zones DNS priv√©es**, permettant la r√©solution de noms **au sein des r√©seaux virtuels Azure**.

### Avantages :
- Utiliser vos **propres noms de domaine** internes (sans suffixe Azure).  
- B√©n√©ficier d‚Äôune **inscription automatique** des VMs dans la zone (pour le VNet enregistr√©).  
- √âviter la gestion manuelle de serveurs DNS internes avec toute sa complexit√©.

### Fonctionnement :
- Une zone priv√©e peut √™tre **li√©e √† plusieurs VNets** :  
  - Le **VNet d‚Äôenregistrement** enregistre automatiquement ses VMs.  
  - Les autres VNets (appel√©s **VNets de r√©solution**) doivent √™tre li√©s manuellement.  
- Les requ√™tes inter-VNet ne n√©cessitent pas de peering ou de VPN.

### Cr√©ation via le portail Azure :
1. Recherchez **Private DNS Zones**.  
2. Cliquez sur **Cr√©er**.  
3. Saisissez le **nom de domaine** (ex. `corp.local`) et le **groupe de ressources**.  
4. Une fois la zone cr√©√©e, ajoutez un **Virtual Network Link** pour associer vos VNets.  

---

## üß≠ En r√©sum√©

Azure DNS offre une **plateforme compl√®te et manag√©e** pour :
- h√©berger vos zones publiques et priv√©es,  
- d√©l√©guer des domaines depuis vos registrars,  
- configurer des enregistrements avanc√©s (alias, SRV, CAA...),  
- et int√©grer vos environnements hybrides (Azure / On-premises) sans infrastructure DNS d√©di√©e.

> Avec ces fonctionnalit√©s, Azure DNS constitue la **colonne vert√©brale de la r√©solution de noms** dans les environnements cloud modernes et hybrides.